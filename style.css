:root {
  --rose-light: #fce4ec;
  --rose: #ef9a9a;
  --rose-deep: #e57373;
  --rose-dark: #c62828;
  --blush: #fff0f3;
  --black: #1a1a1a;
  --white: #ffffff;
  --crimson: #9b1b30;
}

* { margin: 0; padding: 0; box-sizing: border-box; }

body {
  font-family: 'Comfortaa', cursive;
  overflow: hidden;
  width: 100vw;
  height: 100vh;
  height: 100dvh;
  background: var(--black);
  touch-action: manipulation;
  -webkit-tap-highlight-color: transparent;
  -webkit-user-select: none;
  user-select: none;
}

/* ============= FLOATING HEARTS ============= */
.hearts-bg {
  position: fixed; inset: 0;
  pointer-events: none; z-index: 0; overflow: hidden;
}
.floating-heart {
  position: absolute; font-size: 20px; opacity: 0;
  animation: floatUp linear infinite;
}
@keyframes floatUp {
  0%   { transform: translateY(100vh) rotate(0deg) scale(0.5); opacity: 0; }
  10%  { opacity: 0.5; }
  90%  { opacity: 0.35; }
  100% { transform: translateY(-10vh) rotate(360deg) scale(1.2); opacity: 0; }
}

/* ============= SCREEN 1: QUESTION ============= */
#screen-question {
  position: fixed; inset: 0; z-index: 10;
  display: flex; flex-direction: column;
  align-items: center; justify-content: center;
  background: linear-gradient(145deg, var(--blush) 0%, var(--rose-light) 40%, var(--rose) 100%);
  transition: opacity 0.8s ease, transform 0.8s ease;
}
#screen-question.hide {
  opacity: 0; transform: scale(1.1); pointer-events: none;
}

.question-container {
  text-align: center;
  animation: fadeInUp 1s ease forwards;
}
@keyframes fadeInUp {
  from { opacity: 0; transform: translateY(40px); }
  to   { opacity: 1; transform: translateY(0); }
}

.big-heart-emoji {
  font-size: 80px; display: block; margin-bottom: 20px;
  animation: heartPulse 1.2s ease-in-out infinite;
}
@keyframes heartPulse {
  0%, 100% { transform: scale(1); }
  50%      { transform: scale(1.15); }
}

.question-title {
  font-family: 'Cormorant Garamond', serif;
  font-size: clamp(28px, 6vw, 56px);
  font-weight: 600;
  color: var(--crimson);
  line-height: 1.2; margin-bottom: 10px;
  text-shadow: 0 2px 15px rgba(155, 27, 48, 0.2);
}

.question-subtitle {
  font-size: clamp(14px, 3vw, 20px);
  color: #a0384e;
  margin-bottom: 50px; font-weight: 300;
  opacity: 0;
  animation: fadeInUp 1s 0.5s ease forwards;
}

.buttons-area {
  display: flex; gap: 24px;
  align-items: center; justify-content: center;
  opacity: 0;
  animation: fadeInUp 1s 1s ease forwards;
}

.btn-yes {
  padding: 18px 50px;
  font-family: 'Comfortaa', cursive;
  font-size: 20px; font-weight: 700;
  border: none; border-radius: 50px; cursor: pointer;
  background: linear-gradient(135deg, var(--rose-deep), var(--rose-dark));
  color: var(--white);
  box-shadow: 0 8px 30px rgba(198, 40, 40, 0.4);
  transition: all 0.3s ease;
  position: relative; overflow: hidden;
}
.btn-yes::before {
  content: ''; position: absolute; inset: 0;
  background: linear-gradient(135deg, var(--rose-dark), #b71c1c);
  opacity: 0; transition: opacity 0.3s; border-radius: 50px;
}
.btn-yes:hover {
  transform: scale(1.08);
  box-shadow: 0 12px 40px rgba(198, 40, 40, 0.6);
}
.btn-yes:hover::before { opacity: 1; }
.btn-yes span { position: relative; z-index: 1; }

/* NO BUTTON â€” uses transform to move, never changes position mode */
.btn-no {
  padding: 14px 36px;
  font-family: 'Comfortaa', cursive;
  font-size: 16px; font-weight: 400;
  border: 2px solid var(--crimson);
  border-radius: 50px; cursor: pointer;
  background: rgba(255,255,255,0.8);
  color: var(--crimson);
  backdrop-filter: blur(4px);
  white-space: nowrap;
  transition: transform 0.5s cubic-bezier(.25,.8,.5,1), background 0.2s;
  /* stays in flex flow, moves visually via transform */
}
.btn-no:hover {
  background: rgba(255,255,255,0.95);
}

/* ============= SCREEN: SAD ============= */
#screen-sad {
  position: fixed; inset: 0; z-index: 20;
  display: none; flex-direction: column;
  align-items: center; justify-content: center;
  background: linear-gradient(145deg, #f5f5f5, #e0e0e0);
  text-align: center; opacity: 0;
  transition: opacity 0.6s ease;
}
#screen-sad.show { display: flex; opacity: 1; }

.sad-gif {
  width: min(280px, 70vw); border-radius: 20px;
  margin-bottom: 30px;
  box-shadow: 0 10px 40px rgba(0,0,0,0.15);
}
.sad-text {
  font-family: 'Cormorant Garamond', serif;
  font-size: clamp(22px, 5vw, 38px);
  color: #444; margin-bottom: 20px;
}
.sad-emoji {
  font-size: 60px; margin-bottom: 20px;
  animation: sadBounce 2s ease infinite;
}
@keyframes sadBounce {
  0%, 100% { transform: translateY(0); }
  50%      { transform: translateY(-10px); }
}
.btn-back {
  padding: 14px 40px;
  font-family: 'Comfortaa', cursive;
  font-size: 16px;
  border: 2px solid #999; border-radius: 50px;
  cursor: pointer; background: white; color: #555;
  transition: all 0.3s; margin-top: 10px;
}
.btn-back:hover {
  background: var(--rose-light);
  border-color: var(--rose-deep);
  color: var(--rose-dark);
}

/* ============= SCREEN 2: STARS ============= */
#screen-stars {
  position: fixed; inset: 0; z-index: 15;
  display: none; background: var(--black); overflow: hidden;
}
#screen-stars.show { display: block; }

canvas#starfield {
  position: absolute; inset: 0; width: 100%; height: 100%;
}

.stars-overlay {
  position: absolute; inset: 0;
  display: flex; flex-direction: column;
  align-items: center; justify-content: center;
  z-index: 5; padding: 30px;
}

/* Single quote cycling in center */
.quote-display {
  text-align: center; max-width: 700px;
  min-height: 200px;
  display: flex; flex-direction: column;
  align-items: center; justify-content: center;
}

.quote-emoji {
  font-size: 64px; margin-bottom: 22px;
  opacity: 0; transform: scale(0.3) rotate(-20deg);
  transition: opacity 0.9s ease, transform 0.9s cubic-bezier(.34,1.56,.64,1);
  cursor: pointer;
  filter: drop-shadow(0 0 0px transparent);
}
.quote-emoji.show {
  opacity: 1; transform: scale(1) rotate(0deg);
  animation: emojiFloat 3s ease-in-out infinite;
  filter: drop-shadow(0 0 20px rgba(255,255,255,0.3));
}
.quote-emoji.hide {
  opacity: 0; transform: scale(0.3) rotate(20deg) translateY(-30px);
}
/* Floating idle animation */
@keyframes emojiFloat {
  0%, 100% { transform: scale(1) translateY(0); }
  50%      { transform: scale(1.08) translateY(-8px); }
}
/* Click/tap burst */
.quote-emoji.pop {
  animation: emojiPop 0.5s ease;
}
@keyframes emojiPop {
  0%  { transform: scale(1); }
  30% { transform: scale(1.5) rotate(15deg); }
  60% { transform: scale(0.9) rotate(-10deg); }
  100%{ transform: scale(1) rotate(0deg); }
}

.quote-text {
  font-family: 'Cormorant Garamond', serif;
  font-size: clamp(20px, 4.5vw, 34px);
  font-style: italic;
  color: var(--white);
  line-height: 1.6; opacity: 0;
  transform: translateY(25px);
  transition: opacity 1s ease, transform 1s ease;
  text-shadow: 0 0 35px rgba(239,154,154,0.35);
}
.quote-text.show {
  opacity: 1; transform: translateY(0);
}
.quote-text.hide {
  opacity: 0; transform: translateY(-25px);
}

/* Counter dots */
.quote-dots {
  display: flex; gap: 10px;
  margin-top: 35px;
}
.quote-dot {
  width: 8px; height: 8px; border-radius: 50%;
  background: rgba(255,255,255,0.2);
  transition: background 0.5s ease, transform 0.5s ease;
}
.quote-dot.active {
  background: var(--rose);
  transform: scale(1.4);
  box-shadow: 0 0 10px rgba(239,154,154,0.6);
}
.quote-dot.done {
  background: rgba(239,154,154,0.5);
}

/* Final summary */
.final-block {
  text-align: center; max-width: 650px;
  opacity: 0; transform: scale(0.85);
  transition: opacity 1.8s ease, transform 1.8s ease;
}
.final-block.visible {
  opacity: 1; transform: scale(1);
}

.final-heart {
  font-size: 70px; display: block; margin-bottom: 18px;
  animation: heartGlow 2s ease-in-out infinite;
  cursor: pointer;
}
@keyframes heartGlow {
  0%, 100% { transform: scale(1); filter: drop-shadow(0 0 12px rgba(229,115,115,0.5)); }
  50%      { transform: scale(1.14); filter: drop-shadow(0 0 40px rgba(229,115,115,1)); }
}
.final-heart.explode {
  animation: heartExplode 0.6s ease;
}
@keyframes heartExplode {
  0%   { transform: scale(1); }
  40%  { transform: scale(1.8); filter: drop-shadow(0 0 60px rgba(229,115,115,1)); }
  100% { transform: scale(1); }
}

.final-title {
  font-family: 'Cormorant Garamond', serif;
  font-size: clamp(26px, 5.5vw, 48px);
  font-weight: 600;
  color: var(--white);
  margin-bottom: 16px; line-height: 1.3;
  text-shadow:
    0 0 10px rgba(255,255,255,0.4),
    0 0 40px rgba(229,115,115,0.4),
    0 0 80px rgba(229,115,115,0.15);
  animation: textGlow 3s ease-in-out infinite alternate;
}
@keyframes textGlow {
  from { text-shadow: 0 0 10px rgba(255,255,255,0.3), 0 0 40px rgba(229,115,115,0.3), 0 0 60px rgba(229,115,115,0.1); }
  to   { text-shadow: 0 0 15px rgba(255,255,255,0.5), 0 0 50px rgba(229,115,115,0.5), 0 0 100px rgba(229,115,115,0.25); }
}
.final-title .highlight {
  background: linear-gradient(135deg, var(--rose), #f48fb1, #ce93d8);
  background-size: 200% 200%;
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  animation: highlightShift 4s ease-in-out infinite alternate;
  filter: drop-shadow(0 0 12px rgba(244,143,177,0.6));
}
@keyframes highlightShift {
  0%   { background-position: 0% 50%; }
  100% { background-position: 100% 50%; }
}

.final-subtitle {
  font-family: 'Comfortaa', cursive;
  font-size: clamp(13px, 2.5vw, 18px);
  color: rgba(255,255,255,0.7);
  margin-bottom: 30px;
  text-shadow: 0 0 15px rgba(255,255,255,0.15);
}
.final-msg {
  font-family: 'Cormorant Garamond', serif;
  font-style: italic;
  font-size: clamp(22px, 4.5vw, 36px);
  color: var(--rose);
  text-shadow:
    0 0 12px rgba(229,115,115,0.6),
    0 0 40px rgba(229,115,115,0.35),
    0 0 80px rgba(229,115,115,0.15);
  animation: msgPulse 2.5s ease-in-out infinite alternate;
}
@keyframes msgPulse {
  from { text-shadow: 0 0 12px rgba(229,115,115,0.5), 0 0 30px rgba(229,115,115,0.25); }
  to   { text-shadow: 0 0 20px rgba(229,115,115,0.8), 0 0 60px rgba(229,115,115,0.4), 0 0 100px rgba(229,115,115,0.2); }
}

/* Mini floating hearts around final heart on click */
.mini-heart {
  position: absolute; pointer-events: none; font-size: 20px;
}

/* Shooting stars */
.shooting-star {
  position: absolute; height: 2px;
  background: linear-gradient(90deg, rgba(255,255,255,0.8), transparent);
  border-radius: 2px;
  animation: shoot linear forwards; z-index: 3;
}
@keyframes shoot {
  from { transform: translateX(0) translateY(0); opacity: 1; }
  to   { transform: translateX(300px) translateY(200px); opacity: 0; }
}

/* Heart burst */
.heart-burst {
  position: fixed; inset: 0; z-index: 25;
  pointer-events: none; display: none;
}
.heart-burst.active { display: block; }
.burst-heart { position: absolute; pointer-events: none; }

/* Rain */
.rain-drop {
  position: absolute; width: 2px; height: 15px;
  background: linear-gradient(to bottom, transparent, rgba(100,150,200,0.4));
  animation: rainFall linear infinite; pointer-events: none;
}
@keyframes rainFall {
  0%   { transform: translateY(-10px); opacity: 0; }
  10%  { opacity: 1; }
  100% { transform: translateY(100vh); opacity: 0; }
}

/* ============= MOBILE ADAPTATION ============= */

/* Phones portrait */
@media (max-width: 600px) {
  .big-heart-emoji {
    font-size: 56px;
    margin-bottom: 14px;
  }
  .question-title {
    font-size: clamp(24px, 7vw, 38px);
    padding: 0 16px;
  }
  .question-subtitle {
    font-size: 14px;
    margin-bottom: 36px;
    padding: 0 20px;
  }
  .buttons-area {
    flex-direction: column;
    gap: 16px;
  }
  .btn-yes {
    padding: 16px 44px;
    font-size: 18px;
  }
  .btn-no {
    padding: 12px 32px;
    font-size: 15px;
  }

  /* Sad screen */
  .sad-emoji { font-size: 48px; margin-bottom: 14px; }
  .sad-gif {
    width: min(220px, 60vw);
    margin-bottom: 20px;
  }
  .sad-text { font-size: clamp(18px, 5vw, 28px); }
  .btn-back {
    padding: 12px 32px;
    font-size: 14px;
  }

  /* Stars screen */
  .stars-overlay { padding: 20px 16px; }
  .quote-display { min-height: 160px; }
  .quote-emoji { font-size: 48px; margin-bottom: 16px; }
  .quote-text {
    font-size: clamp(17px, 4.5vw, 26px);
    padding: 0 8px;
  }
  .quote-dots { margin-top: 24px; gap: 8px; }
  .quote-dot { width: 7px; height: 7px; }

  .final-heart { font-size: 52px; }
  .final-title {
    font-size: clamp(22px, 6vw, 36px);
    padding: 0 10px;
  }
  .final-subtitle { font-size: 13px; padding: 0 10px; }
  .final-msg { font-size: clamp(18px, 5vw, 28px); }
}

/* Very small phones (SE, mini) */
@media (max-width: 380px) {
  .big-heart-emoji { font-size: 44px; }
  .question-title { font-size: clamp(20px, 7vw, 32px); }
  .btn-yes { padding: 14px 36px; font-size: 16px; }
  .btn-no { padding: 10px 26px; font-size: 14px; }
  .quote-emoji { font-size: 40px; }
  .quote-text { font-size: 16px; }
  .final-heart { font-size: 44px; }
  .final-title { font-size: clamp(18px, 6vw, 28px); }
}

/* Landscape phones */
@media (max-height: 500px) and (orientation: landscape) {
  .big-heart-emoji { font-size: 40px; margin-bottom: 8px; }
  .question-title { font-size: clamp(20px, 4vh, 32px); }
  .question-subtitle { margin-bottom: 20px; font-size: 13px; }
  .buttons-area { flex-direction: row; gap: 20px; }
  .btn-yes { padding: 12px 32px; font-size: 16px; }
  .btn-no { padding: 10px 24px; font-size: 14px; }
  .sad-gif { width: min(150px, 30vw); }
  .sad-emoji { font-size: 36px; margin-bottom: 8px; }
  .quote-emoji { font-size: 36px; margin-bottom: 10px; }
  .quote-text { font-size: clamp(15px, 3vh, 22px); }
  .final-heart { font-size: 40px; }
  .final-title { font-size: clamp(18px, 4vh, 32px); }
  .stars-overlay { padding: 12px; }
}

/* Safe areas for notched phones */
@supports (padding: env(safe-area-inset-top)) {
  .stars-overlay {
    padding-top: max(30px, env(safe-area-inset-top));
    padding-bottom: max(30px, env(safe-area-inset-bottom));
    padding-left: max(16px, env(safe-area-inset-left));
    padding-right: max(16px, env(safe-area-inset-right));
  }
  #screen-question, #screen-sad {
    padding: env(safe-area-inset-top) env(safe-area-inset-right) env(safe-area-inset-bottom) env(safe-area-inset-left);
  }
}
/* ============= MUSIC TOGGLE ============= */
.music-btn {
  position: fixed;
  bottom: 20px; right: 20px;
  z-index: 999;
  width: 48px; height: 48px;
  border-radius: 50%;
  border: 2px solid rgba(255,255,255,0.25);
  background: rgba(0,0,0,0.35);
  backdrop-filter: blur(10px);
  color: white;
  font-size: 22px;
  cursor: pointer;
  display: flex; align-items: center; justify-content: center;
  transition: all 0.3s ease;
  opacity: 0;
  animation: musicBtnIn 1s 2s ease forwards;
}
.music-btn:hover {
  background: rgba(229,115,115,0.3);
  border-color: var(--rose);
  transform: scale(1.1);
}
.music-btn.playing .bar { animation-play-state: running; }
.music-btn .bars {
  display: flex; align-items: flex-end; gap: 3px; height: 18px;
}
.music-btn .bar {
  width: 3px; border-radius: 2px;
  background: white;
  animation: barPulse 0.8s ease-in-out infinite;
  animation-play-state: paused;
}
.music-btn .bar:nth-child(1) { height: 8px; animation-delay: 0s; }
.music-btn .bar:nth-child(2) { height: 14px; animation-delay: 0.15s; }
.music-btn .bar:nth-child(3) { height: 10px; animation-delay: 0.3s; }
.music-btn .bar:nth-child(4) { height: 16px; animation-delay: 0.1s; }
.music-btn.muted .bar {
  animation: none;
  height: 3px !important;
  opacity: 0.4;
}
.song-label {
  position: fixed;
  bottom: 24px; right: 70px;
  z-index: 999;
  font-family: 'Comfortaa', cursive;
  font-size: 11px;
  color: rgba(255,255,255,0.45);
  opacity: 0;
  transition: opacity 0.8s ease;
  pointer-events: none;
  white-space: nowrap;
}
.song-label.show { opacity: 1; }
@keyframes barPulse {
  0%, 100% { transform: scaleY(1); }
  50% { transform: scaleY(0.4); }
}
@keyframes musicBtnIn {
  to { opacity: 1; }
}

@media (max-width: 600px) {
  .music-btn {
    width: 42px; height: 42px;
    bottom: 14px; right: 14px;
    font-size: 18px;
  }
  .song-label {
    bottom: 18px; right: 62px;
    font-size: 10px;
  }
}
@supports (padding: env(safe-area-inset-bottom)) {
  .music-btn {
    bottom: max(20px, calc(env(safe-area-inset-bottom) + 8px));
    right: max(20px, calc(env(safe-area-inset-right) + 8px));
  }
}
