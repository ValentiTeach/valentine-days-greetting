<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>üíù –î–ª—è —Ç–µ–±–µ...</title>
<link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,400;0,600;1,400;1,600&family=Comfortaa:wght@300;400;700&display=swap" rel="stylesheet">
<style>
  :root {
    --rose-light: #fce4ec;
    --rose: #ef9a9a;
    --rose-deep: #e57373;
    --rose-dark: #c62828;
    --blush: #fff0f3;
    --black: #1a1a1a;
    --white: #ffffff;
    --crimson: #9b1b30;
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    font-family: 'Comfortaa', cursive;
    overflow: hidden;
    width: 100vw;
    height: 100vh;
    height: 100dvh;
    background: var(--black);
    touch-action: manipulation;
    -webkit-tap-highlight-color: transparent;
    -webkit-user-select: none;
    user-select: none;
  }

  /* ============= FLOATING HEARTS ============= */
  .hearts-bg {
    position: fixed; inset: 0;
    pointer-events: none; z-index: 0; overflow: hidden;
  }
  .floating-heart {
    position: absolute; font-size: 20px; opacity: 0;
    animation: floatUp linear infinite;
  }
  @keyframes floatUp {
    0%   { transform: translateY(100vh) rotate(0deg) scale(0.5); opacity: 0; }
    10%  { opacity: 0.5; }
    90%  { opacity: 0.35; }
    100% { transform: translateY(-10vh) rotate(360deg) scale(1.2); opacity: 0; }
  }

  /* ============= SCREEN 1: QUESTION ============= */
  #screen-question {
    position: fixed; inset: 0; z-index: 10;
    display: flex; flex-direction: column;
    align-items: center; justify-content: center;
    background: linear-gradient(145deg, var(--blush) 0%, var(--rose-light) 40%, var(--rose) 100%);
    transition: opacity 0.8s ease, transform 0.8s ease;
  }
  #screen-question.hide {
    opacity: 0; transform: scale(1.1); pointer-events: none;
  }

  .question-container {
    text-align: center;
    animation: fadeInUp 1s ease forwards;
  }
  @keyframes fadeInUp {
    from { opacity: 0; transform: translateY(40px); }
    to   { opacity: 1; transform: translateY(0); }
  }

  .big-heart-emoji {
    font-size: 80px; display: block; margin-bottom: 20px;
    animation: heartPulse 1.2s ease-in-out infinite;
  }
  @keyframes heartPulse {
    0%, 100% { transform: scale(1); }
    50%      { transform: scale(1.15); }
  }

  .question-title {
    font-family: 'Cormorant Garamond', serif;
    font-size: clamp(28px, 6vw, 56px);
    font-weight: 600;
    color: var(--crimson);
    line-height: 1.2; margin-bottom: 10px;
    text-shadow: 0 2px 15px rgba(155, 27, 48, 0.2);
  }

  .question-subtitle {
    font-size: clamp(14px, 3vw, 20px);
    color: #a0384e;
    margin-bottom: 50px; font-weight: 300;
    opacity: 0;
    animation: fadeInUp 1s 0.5s ease forwards;
  }

  .buttons-area {
    display: flex; gap: 24px;
    align-items: center; justify-content: center;
    opacity: 0;
    animation: fadeInUp 1s 1s ease forwards;
  }

  .btn-yes {
    padding: 18px 50px;
    font-family: 'Comfortaa', cursive;
    font-size: 20px; font-weight: 700;
    border: none; border-radius: 50px; cursor: pointer;
    background: linear-gradient(135deg, var(--rose-deep), var(--rose-dark));
    color: var(--white);
    box-shadow: 0 8px 30px rgba(198, 40, 40, 0.4);
    transition: all 0.3s ease;
    position: relative; overflow: hidden;
  }
  .btn-yes::before {
    content: ''; position: absolute; inset: 0;
    background: linear-gradient(135deg, var(--rose-dark), #b71c1c);
    opacity: 0; transition: opacity 0.3s; border-radius: 50px;
  }
  .btn-yes:hover {
    transform: scale(1.08);
    box-shadow: 0 12px 40px rgba(198, 40, 40, 0.6);
  }
  .btn-yes:hover::before { opacity: 1; }
  .btn-yes span { position: relative; z-index: 1; }

  /* NO BUTTON ‚Äî uses transform to move, never changes position mode */
  .btn-no {
    padding: 14px 36px;
    font-family: 'Comfortaa', cursive;
    font-size: 16px; font-weight: 400;
    border: 2px solid var(--crimson);
    border-radius: 50px; cursor: pointer;
    background: rgba(255,255,255,0.8);
    color: var(--crimson);
    backdrop-filter: blur(4px);
    white-space: nowrap;
    transition: transform 0.5s cubic-bezier(.25,.8,.5,1), background 0.2s;
    /* stays in flex flow, moves visually via transform */
  }
  .btn-no:hover {
    background: rgba(255,255,255,0.95);
  }

  /* ============= SCREEN: SAD ============= */
  #screen-sad {
    position: fixed; inset: 0; z-index: 20;
    display: none; flex-direction: column;
    align-items: center; justify-content: center;
    background: linear-gradient(145deg, #f5f5f5, #e0e0e0);
    text-align: center; opacity: 0;
    transition: opacity 0.6s ease;
  }
  #screen-sad.show { display: flex; opacity: 1; }

  .sad-gif {
    width: min(280px, 70vw); border-radius: 20px;
    margin-bottom: 30px;
    box-shadow: 0 10px 40px rgba(0,0,0,0.15);
  }
  .sad-text {
    font-family: 'Cormorant Garamond', serif;
    font-size: clamp(22px, 5vw, 38px);
    color: #444; margin-bottom: 20px;
  }
  .sad-emoji {
    font-size: 60px; margin-bottom: 20px;
    animation: sadBounce 2s ease infinite;
  }
  @keyframes sadBounce {
    0%, 100% { transform: translateY(0); }
    50%      { transform: translateY(-10px); }
  }
  .btn-back {
    padding: 14px 40px;
    font-family: 'Comfortaa', cursive;
    font-size: 16px;
    border: 2px solid #999; border-radius: 50px;
    cursor: pointer; background: white; color: #555;
    transition: all 0.3s; margin-top: 10px;
  }
  .btn-back:hover {
    background: var(--rose-light);
    border-color: var(--rose-deep);
    color: var(--rose-dark);
  }

  /* ============= SCREEN 2: STARS ============= */
  #screen-stars {
    position: fixed; inset: 0; z-index: 15;
    display: none; background: var(--black); overflow: hidden;
  }
  #screen-stars.show { display: block; }

  canvas#starfield {
    position: absolute; inset: 0; width: 100%; height: 100%;
  }

  .stars-overlay {
    position: absolute; inset: 0;
    display: flex; flex-direction: column;
    align-items: center; justify-content: center;
    z-index: 5; padding: 30px;
  }

  /* Single quote cycling in center */
  .quote-display {
    text-align: center; max-width: 700px;
    min-height: 200px;
    display: flex; flex-direction: column;
    align-items: center; justify-content: center;
  }

  .quote-emoji {
    font-size: 64px; margin-bottom: 22px;
    opacity: 0; transform: scale(0.3) rotate(-20deg);
    transition: opacity 0.9s ease, transform 0.9s cubic-bezier(.34,1.56,.64,1);
    cursor: pointer;
    filter: drop-shadow(0 0 0px transparent);
  }
  .quote-emoji.show {
    opacity: 1; transform: scale(1) rotate(0deg);
    animation: emojiFloat 3s ease-in-out infinite;
    filter: drop-shadow(0 0 20px rgba(255,255,255,0.3));
  }
  .quote-emoji.hide {
    opacity: 0; transform: scale(0.3) rotate(20deg) translateY(-30px);
  }
  /* Floating idle animation */
  @keyframes emojiFloat {
    0%, 100% { transform: scale(1) translateY(0); }
    50%      { transform: scale(1.08) translateY(-8px); }
  }
  /* Click/tap burst */
  .quote-emoji.pop {
    animation: emojiPop 0.5s ease;
  }
  @keyframes emojiPop {
    0%  { transform: scale(1); }
    30% { transform: scale(1.5) rotate(15deg); }
    60% { transform: scale(0.9) rotate(-10deg); }
    100%{ transform: scale(1) rotate(0deg); }
  }

  .quote-text {
    font-family: 'Cormorant Garamond', serif;
    font-size: clamp(20px, 4.5vw, 34px);
    font-style: italic;
    color: var(--white);
    line-height: 1.6; opacity: 0;
    transform: translateY(25px);
    transition: opacity 1s ease, transform 1s ease;
    text-shadow: 0 0 35px rgba(239,154,154,0.35);
  }
  .quote-text.show {
    opacity: 1; transform: translateY(0);
  }
  .quote-text.hide {
    opacity: 0; transform: translateY(-25px);
  }

  /* Counter dots */
  .quote-dots {
    display: flex; gap: 10px;
    margin-top: 35px;
  }
  .quote-dot {
    width: 8px; height: 8px; border-radius: 50%;
    background: rgba(255,255,255,0.2);
    transition: background 0.5s ease, transform 0.5s ease;
  }
  .quote-dot.active {
    background: var(--rose);
    transform: scale(1.4);
    box-shadow: 0 0 10px rgba(239,154,154,0.6);
  }
  .quote-dot.done {
    background: rgba(239,154,154,0.5);
  }

  /* Final summary */
  .final-block {
    text-align: center; max-width: 650px;
    opacity: 0; transform: scale(0.85);
    transition: opacity 1.8s ease, transform 1.8s ease;
  }
  .final-block.visible {
    opacity: 1; transform: scale(1);
  }

  .final-heart {
    font-size: 70px; display: block; margin-bottom: 18px;
    animation: heartGlow 2s ease-in-out infinite;
    cursor: pointer;
  }
  @keyframes heartGlow {
    0%, 100% { transform: scale(1); filter: drop-shadow(0 0 12px rgba(229,115,115,0.5)); }
    50%      { transform: scale(1.14); filter: drop-shadow(0 0 40px rgba(229,115,115,1)); }
  }
  .final-heart.explode {
    animation: heartExplode 0.6s ease;
  }
  @keyframes heartExplode {
    0%   { transform: scale(1); }
    40%  { transform: scale(1.8); filter: drop-shadow(0 0 60px rgba(229,115,115,1)); }
    100% { transform: scale(1); }
  }

  .final-title {
    font-family: 'Cormorant Garamond', serif;
    font-size: clamp(26px, 5.5vw, 48px);
    font-weight: 600;
    color: var(--white);
    margin-bottom: 16px; line-height: 1.3;
    text-shadow:
      0 0 10px rgba(255,255,255,0.4),
      0 0 40px rgba(229,115,115,0.4),
      0 0 80px rgba(229,115,115,0.15);
    animation: textGlow 3s ease-in-out infinite alternate;
  }
  @keyframes textGlow {
    from { text-shadow: 0 0 10px rgba(255,255,255,0.3), 0 0 40px rgba(229,115,115,0.3), 0 0 60px rgba(229,115,115,0.1); }
    to   { text-shadow: 0 0 15px rgba(255,255,255,0.5), 0 0 50px rgba(229,115,115,0.5), 0 0 100px rgba(229,115,115,0.25); }
  }
  .final-title .highlight {
    background: linear-gradient(135deg, var(--rose), #f48fb1, #ce93d8);
    background-size: 200% 200%;
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    animation: highlightShift 4s ease-in-out infinite alternate;
    filter: drop-shadow(0 0 12px rgba(244,143,177,0.6));
  }
  @keyframes highlightShift {
    0%   { background-position: 0% 50%; }
    100% { background-position: 100% 50%; }
  }

  .final-subtitle {
    font-family: 'Comfortaa', cursive;
    font-size: clamp(13px, 2.5vw, 18px);
    color: rgba(255,255,255,0.7);
    margin-bottom: 30px;
    text-shadow: 0 0 15px rgba(255,255,255,0.15);
  }
  .final-msg {
    font-family: 'Cormorant Garamond', serif;
    font-style: italic;
    font-size: clamp(22px, 4.5vw, 36px);
    color: var(--rose);
    text-shadow:
      0 0 12px rgba(229,115,115,0.6),
      0 0 40px rgba(229,115,115,0.35),
      0 0 80px rgba(229,115,115,0.15);
    animation: msgPulse 2.5s ease-in-out infinite alternate;
  }
  @keyframes msgPulse {
    from { text-shadow: 0 0 12px rgba(229,115,115,0.5), 0 0 30px rgba(229,115,115,0.25); }
    to   { text-shadow: 0 0 20px rgba(229,115,115,0.8), 0 0 60px rgba(229,115,115,0.4), 0 0 100px rgba(229,115,115,0.2); }
  }

  /* Mini floating hearts around final heart on click */
  .mini-heart {
    position: absolute; pointer-events: none; font-size: 20px;
  }

  /* Shooting stars */
  .shooting-star {
    position: absolute; height: 2px;
    background: linear-gradient(90deg, rgba(255,255,255,0.8), transparent);
    border-radius: 2px;
    animation: shoot linear forwards; z-index: 3;
  }
  @keyframes shoot {
    from { transform: translateX(0) translateY(0); opacity: 1; }
    to   { transform: translateX(300px) translateY(200px); opacity: 0; }
  }

  /* Heart burst */
  .heart-burst {
    position: fixed; inset: 0; z-index: 25;
    pointer-events: none; display: none;
  }
  .heart-burst.active { display: block; }
  .burst-heart { position: absolute; pointer-events: none; }

  /* Rain */
  .rain-drop {
    position: absolute; width: 2px; height: 15px;
    background: linear-gradient(to bottom, transparent, rgba(100,150,200,0.4));
    animation: rainFall linear infinite; pointer-events: none;
  }
  @keyframes rainFall {
    0%   { transform: translateY(-10px); opacity: 0; }
    10%  { opacity: 1; }
    100% { transform: translateY(100vh); opacity: 0; }
  }

  /* ============= MOBILE ADAPTATION ============= */

  /* Phones portrait */
  @media (max-width: 600px) {
    .big-heart-emoji {
      font-size: 56px;
      margin-bottom: 14px;
    }
    .question-title {
      font-size: clamp(24px, 7vw, 38px);
      padding: 0 16px;
    }
    .question-subtitle {
      font-size: 14px;
      margin-bottom: 36px;
      padding: 0 20px;
    }
    .buttons-area {
      flex-direction: column;
      gap: 16px;
    }
    .btn-yes {
      padding: 16px 44px;
      font-size: 18px;
    }
    .btn-no {
      padding: 12px 32px;
      font-size: 15px;
    }

    /* Sad screen */
    .sad-emoji { font-size: 48px; margin-bottom: 14px; }
    .sad-gif {
      width: min(220px, 60vw);
      margin-bottom: 20px;
    }
    .sad-text { font-size: clamp(18px, 5vw, 28px); }
    .btn-back {
      padding: 12px 32px;
      font-size: 14px;
    }

    /* Stars screen */
    .stars-overlay { padding: 20px 16px; }
    .quote-display { min-height: 160px; }
    .quote-emoji { font-size: 48px; margin-bottom: 16px; }
    .quote-text {
      font-size: clamp(17px, 4.5vw, 26px);
      padding: 0 8px;
    }
    .quote-dots { margin-top: 24px; gap: 8px; }
    .quote-dot { width: 7px; height: 7px; }

    .final-heart { font-size: 52px; }
    .final-title {
      font-size: clamp(22px, 6vw, 36px);
      padding: 0 10px;
    }
    .final-subtitle { font-size: 13px; padding: 0 10px; }
    .final-msg { font-size: clamp(18px, 5vw, 28px); }
  }

  /* Very small phones (SE, mini) */
  @media (max-width: 380px) {
    .big-heart-emoji { font-size: 44px; }
    .question-title { font-size: clamp(20px, 7vw, 32px); }
    .btn-yes { padding: 14px 36px; font-size: 16px; }
    .btn-no { padding: 10px 26px; font-size: 14px; }
    .quote-emoji { font-size: 40px; }
    .quote-text { font-size: 16px; }
    .final-heart { font-size: 44px; }
    .final-title { font-size: clamp(18px, 6vw, 28px); }
  }

  /* Landscape phones */
  @media (max-height: 500px) and (orientation: landscape) {
    .big-heart-emoji { font-size: 40px; margin-bottom: 8px; }
    .question-title { font-size: clamp(20px, 4vh, 32px); }
    .question-subtitle { margin-bottom: 20px; font-size: 13px; }
    .buttons-area { flex-direction: row; gap: 20px; }
    .btn-yes { padding: 12px 32px; font-size: 16px; }
    .btn-no { padding: 10px 24px; font-size: 14px; }
    .sad-gif { width: min(150px, 30vw); }
    .sad-emoji { font-size: 36px; margin-bottom: 8px; }
    .quote-emoji { font-size: 36px; margin-bottom: 10px; }
    .quote-text { font-size: clamp(15px, 3vh, 22px); }
    .final-heart { font-size: 40px; }
    .final-title { font-size: clamp(18px, 4vh, 32px); }
    .stars-overlay { padding: 12px; }
  }

  /* Safe areas for notched phones */
  @supports (padding: env(safe-area-inset-top)) {
    .stars-overlay {
      padding-top: max(30px, env(safe-area-inset-top));
      padding-bottom: max(30px, env(safe-area-inset-bottom));
      padding-left: max(16px, env(safe-area-inset-left));
      padding-right: max(16px, env(safe-area-inset-right));
    }
    #screen-question, #screen-sad {
      padding: env(safe-area-inset-top) env(safe-area-inset-right) env(safe-area-inset-bottom) env(safe-area-inset-left);
    }
  }
  /* ============= MUSIC TOGGLE ============= */
  .music-btn {
    position: fixed;
    bottom: 20px; right: 20px;
    z-index: 999;
    width: 48px; height: 48px;
    border-radius: 50%;
    border: 2px solid rgba(255,255,255,0.25);
    background: rgba(0,0,0,0.35);
    backdrop-filter: blur(10px);
    color: white;
    font-size: 22px;
    cursor: pointer;
    display: flex; align-items: center; justify-content: center;
    transition: all 0.3s ease;
    opacity: 0;
    animation: musicBtnIn 1s 2s ease forwards;
  }
  .music-btn:hover {
    background: rgba(229,115,115,0.3);
    border-color: var(--rose);
    transform: scale(1.1);
  }
  .music-btn.playing .bar { animation-play-state: running; }
  .music-btn .bars {
    display: flex; align-items: flex-end; gap: 3px; height: 18px;
  }
  .music-btn .bar {
    width: 3px; border-radius: 2px;
    background: white;
    animation: barPulse 0.8s ease-in-out infinite;
    animation-play-state: paused;
  }
  .music-btn .bar:nth-child(1) { height: 8px; animation-delay: 0s; }
  .music-btn .bar:nth-child(2) { height: 14px; animation-delay: 0.15s; }
  .music-btn .bar:nth-child(3) { height: 10px; animation-delay: 0.3s; }
  .music-btn .bar:nth-child(4) { height: 16px; animation-delay: 0.1s; }
  .music-btn.muted .bar {
    animation: none;
    height: 3px !important;
    opacity: 0.4;
  }
  .song-label {
    position: fixed;
    bottom: 24px; right: 70px;
    z-index: 999;
    font-family: 'Comfortaa', cursive;
    font-size: 11px;
    color: rgba(255,255,255,0.45);
    opacity: 0;
    transition: opacity 0.8s ease;
    pointer-events: none;
    white-space: nowrap;
  }
  .song-label.show { opacity: 1; }
  @keyframes barPulse {
    0%, 100% { transform: scaleY(1); }
    50% { transform: scaleY(0.4); }
  }
  @keyframes musicBtnIn {
    to { opacity: 1; }
  }

  @media (max-width: 600px) {
    .music-btn {
      width: 42px; height: 42px;
      bottom: 14px; right: 14px;
      font-size: 18px;
    }
    .song-label {
      bottom: 18px; right: 62px;
      font-size: 10px;
    }
  }
  @supports (padding: env(safe-area-inset-bottom)) {
    .music-btn {
      bottom: max(20px, calc(env(safe-area-inset-bottom) + 8px));
      right: max(20px, calc(env(safe-area-inset-right) + 8px));
    }
  }
</style>
</head>
<body>

<div class="hearts-bg" id="heartsBg"></div>

<!-- SCREEN 1 -->
<div id="screen-question">
  <div class="question-container">
    <span class="big-heart-emoji">üíù</span>
    <h1 class="question-title">–ß–∏ –±—É–¥–µ—à –º–æ—î—é<br>–í–∞–ª–µ–Ω—Ç–∏–Ω–∫–æ—é? üíï</h1>
    <p class="question-subtitle">–¢–∏—Å–Ω–∏ —ñ –¥—ñ–∑–Ω–∞–π—Å—è, —â–æ –±—É–¥–µ –¥–∞–ª—ñ... üåπ</p>
    <div class="buttons-area" id="buttonsArea">
      <button class="btn-yes" id="btnYes" onclick="handleYes()"><span>–¢–∞–∫! üíñ</span></button>
      <button class="btn-no" id="btnNo" onclick="handleNo()">–ù—ñ üôÉ</button>
    </div>
  </div>
</div>

<!-- SAD SCREEN -->
<div id="screen-sad">
  <div class="sad-emoji">üò¢üíî</div>
  <img class="sad-gif" src="https://media.giphy.com/media/v1.Y2lkPTc5MGI3NjExcjRhNGkyeGFkcDZmbnl1aWluYWVlc3c5ODR3b2dkNnU3NnM2bmtxdiZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/OPU6wzx8JrHna/giphy.gif" alt="sad cat">
  <p class="sad-text">–ù—É –æ—Ç... –¶–µ —Å–ø—Ä–∞–≤–¥—ñ —Å—É–º–Ω–æ üòø</p>
  <p style="color:#777; font-size: 14px; margin-bottom: 20px;">–ú–æ–∂–µ –≤—Å–µ –∂ —Ç–∞–∫–∏ –ø–µ—Ä–µ–¥—É–º–∞—î—à?</p>
  <button class="btn-back" onclick="goBack()">–ü–æ–≤–µ—Ä–Ω—É—Ç–∏—Å—è üîô</button>
</div>

<!-- STARS SCREEN -->
<div id="screen-stars">
  <canvas id="starfield"></canvas>
  <div class="stars-overlay">
    <div class="quote-display" id="quoteDisplay">
      <div class="quote-emoji" id="quoteEmoji">üåü</div>
      <p class="quote-text" id="quoteText"></p>
      <div class="quote-dots" id="quoteDots"></div>
    </div>

    <div class="final-block" id="finalBlock" style="display:none;">
      <span class="final-heart" id="finalHeart" onclick="popFinalHeart(this)">üíó</span>
      <h2 class="final-title">–¢–∏ ‚Äî –º–æ—è <span class="highlight">–∑—ñ—Ä–∫–∞</span> ‚ú®<br>—Å–µ—Ä–µ–¥ –º—ñ–ª—å—è—Ä–¥—ñ–≤ —É –≤—Å–µ—Å–≤—ñ—Ç—ñ</h2>
      <p class="final-subtitle">–¢–∏ –æ–±—Ä–∞–ª–∞ ¬´–¢–∞–∫¬ª ‚Äî —ñ —Ü–µ –Ω–∞–π–∫—Ä–∞—â–∏–π –º–æ–º–µ–Ω—Ç ü•π</p>
      <p class="final-msg">–ó –î–Ω–µ–º –°–≤—è—Ç–æ–≥–æ –í–∞–ª–µ–Ω—Ç–∏–Ω–∞, –∫–æ—Ö–∞–Ω–∞ üíù</p>
    </div>
  </div>
</div>

<!-- Music: SadSvit ‚Äî –û—Å—Ç–∞–Ω–Ω—ñ–π –¥–µ–Ω—å -->
<audio id="bgMusic" loop preload="auto">
  <source src="music.mp3" type="audio/mpeg">
</audio>

<!-- Music Toggle -->
<button class="music-btn muted" id="musicBtn" onclick="toggleMusic()" title="–ú—É–∑–∏–∫–∞ üéµ SadSvit ‚Äî –û—Å—Ç–∞–Ω–Ω—ñ–π –¥–µ–Ω—å">
  <div class="bars">
    <div class="bar"></div><div class="bar"></div><div class="bar"></div><div class="bar"></div>
  </div>
</button>
<div class="song-label" id="songLabel">‚ô™ SadSvit ‚Äî –û—Å—Ç–∞–Ω–Ω—ñ–π –¥–µ–Ω—å</div>

<div class="heart-burst" id="heartBurst"></div>

<script>
  // ============= DETECT MOBILE =============
  const isMobile = 'ontouchstart' in window || navigator.maxTouchPoints > 0;
  const heartInterval = isMobile ? 700 : 400;
  const maxFloatingHearts = isMobile ? 8 : 15;

  // ============= FLOATING HEARTS =============
  const heartEmojis = ['‚ù§Ô∏è','üíï','üíó','üíñ','üíù','ü©∑','üåπ','‚ú®'];
  const heartsBg = document.getElementById('heartsBg');
  function createFloatingHeart() {
    // Limit total hearts on screen for mobile performance
    if (heartsBg.children.length > (isMobile ? 20 : 40)) return;
    const h = document.createElement('div');
    h.className = 'floating-heart';
    h.textContent = heartEmojis[Math.floor(Math.random() * heartEmojis.length)];
    h.style.left = Math.random() * 100 + '%';
    h.style.fontSize = (15 + Math.random() * 25) + 'px';
    h.style.animationDuration = (6 + Math.random() * 8) + 's';
    h.style.animationDelay = Math.random() * 2 + 's';
    heartsBg.appendChild(h);
    setTimeout(() => h.remove(), 16000);
  }
  setInterval(createFloatingHeart, heartInterval);
  for (let i = 0; i < maxFloatingHearts; i++) setTimeout(createFloatingHeart, i * 200);

  // ============= NO BUTTON ‚Äî transform-based, never leaves flow =============
  const btnNo = document.getElementById('btnNo');
  const btnYes = document.getElementById('btnYes');
  let noClickable = true;
  let flyCount = 0;
  let translateX = 0, translateY = 0;
  const noTexts = ['–ù—ñ üôÉ', '–¢–æ—á–Ω–æ –Ω—ñ? ü•∫', '–ü–æ–¥—É–º–∞–π —â–µ... üò¢', '–°–µ—Ä–π–æ–∑–Ω–æ?! üíî', '–ù—É –±—É–¥—å –ª–∞—Å–∫–∞! ü•π', '–û—Å—Ç–∞–Ω–Ω—ñ–π —à–∞–Ω—Å! üò≠'];

  function flyNoButton(cursorX, cursorY) {
    if (!noClickable) return;

    const rect = btnNo.getBoundingClientRect();
    const btnCX = rect.left + rect.width / 2;
    const btnCY = rect.top + rect.height / 2;
    const dist = Math.hypot(cursorX - btnCX, cursorY - btnCY);

    // Bigger detection zone on mobile (fingers are less precise)
    const detectRadius = isMobile ? 90 : 120;

    if (dist < detectRadius) {
      flyCount++;

      // Gentle flee away from cursor
      const angle = Math.atan2(btnCY - cursorY, btnCX - cursorX);
      const spread = (Math.random() - 0.5) * Math.PI * 0.5;
      const fleeDist = isMobile ? (50 + Math.random() * 60) : (60 + Math.random() * 70);

      let newTX = translateX + Math.cos(angle + spread) * fleeDist;
      let newTY = translateY + Math.sin(angle + spread) * fleeDist;

      // Clamp: stay within radius of origin
      const maxRadius = isMobile ? 180 : 250;
      const currentDist = Math.hypot(newTX, newTY);
      if (currentDist > maxRadius) {
        newTX = (newTX / currentDist) * maxRadius;
        newTY = (newTY / currentDist) * maxRadius;
      }

      // Keep within viewport
      const origCX = rect.left + rect.width / 2 - translateX;
      const origCY = rect.top + rect.height / 2 - translateY;
      const pad = 10;
      newTX = Math.max(-origCX + pad, Math.min(window.innerWidth - origCX - rect.width + pad, newTX));
      newTY = Math.max(-origCY + pad, Math.min(window.innerHeight - origCY - rect.height + pad, newTY));

      translateX = newTX;
      translateY = newTY;
      btnNo.style.transform = `translate(${translateX}px, ${translateY}px)`;

      if (flyCount < noTexts.length) {
        btnNo.textContent = noTexts[flyCount];
      }

      // Grow Yes slightly
      const scale = 1 + flyCount * 0.05;
      btnYes.style.transform = `scale(${Math.min(scale, 1.35)})`;
    }
  }

  document.addEventListener('mousemove', e => flyNoButton(e.clientX, e.clientY));

  // Mobile: flee on both touchstart (finger lands near) and touchmove (finger slides near)
  document.addEventListener('touchstart', e => {
    const t = e.touches[0];
    flyNoButton(t.clientX, t.clientY);
  }, { passive: true });
  document.addEventListener('touchmove', e => {
    const t = e.touches[0];
    flyNoButton(t.clientX, t.clientY);
  }, { passive: true });

  // ============= YES =============
  function handleYes() {
    autoStartMusic();
    triggerHeartBurst();
    setTimeout(() => {
      document.getElementById('screen-question').classList.add('hide');
      setTimeout(() => {
        document.getElementById('screen-stars').classList.add('show');
        initStarfield();
        startQuoteSequence();
        launchShootingStars();
      }, 400);
    }, 600);
  }

  // ============= NO =============
  function handleNo() {
    autoStartMusic();
    noClickable = false;
    const sadScreen = document.getElementById('screen-sad');
    document.getElementById('screen-question').classList.add('hide');
    const rainCount = isMobile ? 25 : 50;
    for (let i = 0; i < rainCount; i++) {
      const d = document.createElement('div');
      d.className = 'rain-drop';
      d.style.left = Math.random() * 100 + '%';
      d.style.animationDuration = (0.8 + Math.random() * 0.6) + 's';
      d.style.animationDelay = Math.random() * 2 + 's';
      sadScreen.appendChild(d);
    }
    setTimeout(() => {
      sadScreen.classList.add('show');
      setTimeout(() => { sadScreen.style.opacity = '1'; }, 50);
    }, 400);
  }

  function goBack() {
    const s = document.getElementById('screen-sad');
    s.style.opacity = '0';
    setTimeout(() => {
      s.classList.remove('show');
      s.querySelectorAll('.rain-drop').forEach(d => d.remove());
      document.getElementById('screen-question').classList.remove('hide');
      noClickable = true;
      translateX = 0; translateY = 0;
      btnNo.style.transform = 'translate(0,0)';
      flyCount = 0;
      btnNo.textContent = noTexts[0];
      btnYes.style.transform = 'scale(1)';
    }, 600);
  }

  // ============= HEART BURST =============
  function triggerHeartBurst() {
    const burst = document.getElementById('heartBurst');
    burst.classList.add('active');
    const cx = window.innerWidth / 2, cy = window.innerHeight / 2;
    const hearts = ['‚ù§Ô∏è','üíñ','üíó','üíï','üíù','ü©∑','‚ú®','üí´','üåü'];
    const burstCount = isMobile ? 24 : 40;
    for (let i = 0; i < burstCount; i++) {
      const h = document.createElement('div');
      h.className = 'burst-heart';
      h.textContent = hearts[Math.floor(Math.random() * hearts.length)];
      h.style.left = cx + 'px'; h.style.top = cy + 'px';
      h.style.fontSize = (16 + Math.random() * 30) + 'px';
      const a = (Math.PI * 2 / burstCount) * i + Math.random() * 0.3;
      const d = (isMobile ? 60 : 100) + Math.random() * (isMobile ? 180 : 300);
      h.animate([
        { transform: 'translate(0,0) scale(0) rotate(0deg)', opacity: 1 },
        { transform: `translate(${Math.cos(a)*d}px,${Math.sin(a)*d}px) scale(1.5) rotate(${Math.random()*360}deg)`, opacity: 0 }
      ], { duration: 1200 + Math.random() * 500, easing: 'cubic-bezier(.25,.46,.45,.94)', fill: 'forwards' });
      burst.appendChild(h);
    }
    setTimeout(() => { burst.innerHTML = ''; burst.classList.remove('active'); }, 2000);
  }

  // ============= QUOTE SEQUENCE =============
  const quotes = [
    { emoji: 'üåü', text: '–¢–∏ ‚Äî —Ç–∞ —î–¥–∏–Ω–∞, —Ö—Ç–æ –∑–º—É—à—É—î –º–æ—î —Å–µ—Ä—Ü–µ –±–∏—Ç–∏—Å—è —à–≤–∏–¥—à–µ' },
    { emoji: 'ü¶ã', text: '–ó —Ç–æ–±–æ—é –∫–æ–∂–Ω–∞ –º–∏—Ç—å ‚Äî —è–∫ –ø–µ—Ä—à–∏–π –ø–æ–¥–∏—Ö –≤–µ—Å–Ω–∏' },
    { emoji: 'üî•', text: '–¢–≤–æ—è —É—Å–º—ñ—à–∫–∞ ‚Äî –Ω–∞–π—Ç–µ–ø–ª—ñ—à–∏–π –≤–æ–≥–æ–Ω—å —É —Ö–æ–ª–æ–¥–Ω—É –Ω—ñ—á' },
    { emoji: 'üåô', text: '–¢–∏ ‚Äî –º—ñ—Å—è—Ü—å, —â–æ –æ—Å–≤—ñ—Ç–ª—é—î –º—ñ–π –Ω–∞–π—Ç–µ–º–Ω—ñ—à–∏–π —à–ª—è—Ö' },
    { emoji: 'üí´', text: '–°–µ—Ä–µ–¥ —É—Å—ñ—Ö –∑—ñ—Ä–æ–∫ —è –æ–±—Ä–∞–≤ –±–∏ —Ç–µ–±–µ –∑–Ω–æ–≤—É —ñ –∑–Ω–æ–≤—É' },
    { emoji: 'üåπ', text: '–¢–∏ —É–Ω—ñ–∫–∞–ª—å–Ω–∞. –¢–∏ –Ω–µ–ø–æ–≤—Ç–æ—Ä–Ω–∞. –¢–∏ ‚Äî –º–æ—è.' },
  ];

  function startQuoteSequence() {
    const emojiEl = document.getElementById('quoteEmoji');
    const textEl = document.getElementById('quoteText');
    const quoteDisplay = document.getElementById('quoteDisplay');
    const dotsContainer = document.getElementById('quoteDots');

    // Create dots
    quotes.forEach(() => {
      const dot = document.createElement('div');
      dot.className = 'quote-dot';
      dotsContainer.appendChild(dot);
    });
    const dots = dotsContainer.querySelectorAll('.quote-dot');

    // Click/tap emoji for pop effect
    emojiEl.addEventListener('click', () => {
      emojiEl.classList.remove('pop');
      void emojiEl.offsetWidth;
      emojiEl.classList.add('pop');
      spawnMiniHearts(emojiEl);
    });

    let index = 0;

    function showQuote() {
      if (index >= quotes.length) {
        quoteDisplay.style.transition = 'opacity 0.8s ease';
        quoteDisplay.style.opacity = '0';
        setTimeout(() => {
          quoteDisplay.style.display = 'none';
          const fb = document.getElementById('finalBlock');
          fb.style.display = '';
          requestAnimationFrame(() => requestAnimationFrame(() => fb.classList.add('visible')));
        }, 900);
        return;
      }

      const q = quotes[index];
      emojiEl.textContent = q.emoji;
      textEl.textContent = q.text;

      // Update dots
      dots.forEach((d, i) => {
        d.classList.remove('active', 'done');
        if (i < index) d.classList.add('done');
        if (i === index) d.classList.add('active');
      });

      // Reset
      emojiEl.className = 'quote-emoji';
      textEl.className = 'quote-text';
      void emojiEl.offsetWidth;

      // Fade in
      requestAnimationFrame(() => {
        emojiEl.classList.add('show');
        textEl.classList.add('show');
      });

      // Fade out
      setTimeout(() => {
        emojiEl.classList.remove('show');
        emojiEl.classList.add('hide');
        textEl.classList.remove('show');
        textEl.classList.add('hide');
      }, 3800);

      index++;
      setTimeout(showQuote, 5000);
    }

    setTimeout(showQuote, 1200);
  }

  // Spawn mini hearts around an element
  function spawnMiniHearts(el) {
    const rect = el.getBoundingClientRect();
    const cx = rect.left + rect.width / 2;
    const cy = rect.top + rect.height / 2;
    const emojis = ['üíñ','‚ù§Ô∏è','üíó','‚ú®','ü©∑'];
    const miniCount = isMobile ? 5 : 8;
    for (let i = 0; i < miniCount; i++) {
      const m = document.createElement('div');
      m.className = 'mini-heart';
      m.textContent = emojis[Math.floor(Math.random() * emojis.length)];
      m.style.left = cx + 'px';
      m.style.top = cy + 'px';
      m.style.fontSize = (14 + Math.random() * 16) + 'px';
      document.body.appendChild(m);
      const a = (Math.PI * 2 / miniCount) * i;
      const d = 40 + Math.random() * 80;
      m.animate([
        { transform: 'translate(-50%,-50%) scale(0)', opacity: 1 },
        { transform: `translate(calc(-50% + ${Math.cos(a)*d}px), calc(-50% + ${Math.sin(a)*d}px)) scale(1.2)`, opacity: 0 }
      ], { duration: 700, easing: 'ease-out', fill: 'forwards' });
      setTimeout(() => m.remove(), 800);
    }
  }

  // Final heart interactive
  function popFinalHeart(el) {
    el.classList.remove('explode');
    void el.offsetWidth;
    el.classList.add('explode');
    spawnMiniHearts(el);
    setTimeout(() => el.classList.remove('explode'), 600);
  }

  // ============= STARFIELD =============
  function initStarfield() {
    const canvas = document.getElementById('starfield');
    const ctx = canvas.getContext('2d');
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
    const starCount = isMobile ? 200 : 400;
    const colorStarCount = isMobile ? 30 : 60;
    const stars = [];
    for (let i = 0; i < starCount; i++) {
      stars.push({ x: Math.random()*canvas.width, y: Math.random()*canvas.height,
        size: Math.random()*2.5, speed: 0.1+Math.random()*0.4,
        opacity: Math.random(), twinkleSpeed: 0.005+Math.random()*0.02, twinkleDir: 1 });
    }
    for (let i = 0; i < colorStarCount; i++) {
      stars.push({ x: Math.random()*canvas.width, y: Math.random()*canvas.height,
        size: 1+Math.random()*2.2, speed: 0.05+Math.random()*0.2,
        opacity: 0.5+Math.random()*0.5, twinkleSpeed: 0.008+Math.random()*0.015,
        twinkleDir: 1, color: `hsl(${340+Math.random()*40}, 80%, ${60+Math.random()*30}%)` });
    }

    function animate() {
      ctx.fillStyle = 'rgba(26,26,26,0.15)';
      ctx.fillRect(0,0,canvas.width,canvas.height);
      stars.forEach(s => {
        s.opacity += s.twinkleSpeed * s.twinkleDir;
        if (s.opacity >= 1) { s.opacity = 1; s.twinkleDir = -1; }
        if (s.opacity <= 0.1) { s.opacity = 0.1; s.twinkleDir = 1; }
        s.y -= s.speed * 0.3;
        if (s.y < -5) { s.y = canvas.height + 5; s.x = Math.random() * canvas.width; }
        ctx.beginPath();
        ctx.arc(s.x, s.y, s.size, 0, Math.PI*2);
        if (s.color) { ctx.globalAlpha = s.opacity; ctx.fillStyle = s.color; }
        else { ctx.fillStyle = `rgba(255,255,255,${s.opacity})`; }
        ctx.fill(); ctx.globalAlpha = 1;
        if (s.size > 1.5) {
          ctx.beginPath();
          ctx.arc(s.x, s.y, s.size*3, 0, Math.PI*2);
          const g = ctx.createRadialGradient(s.x, s.y, 0, s.x, s.y, s.size*3);
          g.addColorStop(0, s.color
            ? s.color.replace('hsl','hsla').replace(')',`, ${s.opacity*0.3})`)
            : `rgba(255,255,255,${s.opacity*0.2})`);
          g.addColorStop(1, 'transparent');
          ctx.fillStyle = g; ctx.fill();
        }
      });
      requestAnimationFrame(animate);
    }
    ctx.fillStyle = '#1a1a1a';
    ctx.fillRect(0,0,canvas.width,canvas.height);
    animate();
    window.addEventListener('resize', () => { canvas.width = window.innerWidth; canvas.height = window.innerHeight; });
  }

  // ============= SHOOTING STARS =============
  function launchShootingStars() {
    function create() {
      const s = document.createElement('div');
      s.className = 'shooting-star';
      s.style.left = Math.random()*60+'%';
      s.style.top = Math.random()*40+'%';
      s.style.width = (60+Math.random()*100)+'px';
      s.style.transform = `rotate(${20+Math.random()*30}deg)`;
      s.style.animationDuration = (0.6+Math.random()*0.5)+'s';
      document.getElementById('screen-stars').appendChild(s);
      setTimeout(() => s.remove(), 1500);
    }
    setInterval(create, 3000+Math.random()*4000);
    setTimeout(create, 2000);
    setTimeout(create, 5000);
  }
  // ============= MUSIC: SadSvit ‚Äî –û—Å—Ç–∞–Ω–Ω—ñ–π –¥–µ–Ω—å =============
  const audio = document.getElementById('bgMusic');
  let musicPlaying = false;
  let fadeInterval = null;

  function fadeAudio(targetVol, duration) {
    clearInterval(fadeInterval);
    const step = 30; // ms per tick
    const ticks = duration / step;
    const diff = (targetVol - audio.volume) / ticks;
    let tick = 0;
    fadeInterval = setInterval(() => {
      tick++;
      audio.volume = Math.max(0, Math.min(1, audio.volume + diff));
      if (tick >= ticks) {
        clearInterval(fadeInterval);
        audio.volume = targetVol;
        if (targetVol === 0) audio.pause();
      }
    }, step);
  }

  function toggleMusic() {
    const btn = document.getElementById('musicBtn');
    const label = document.getElementById('songLabel');

    if (musicPlaying) {
      musicPlaying = false;
      fadeAudio(0, 1000);
      btn.classList.add('muted');
      btn.classList.remove('playing');
      label.classList.remove('show');
    } else {
      musicPlaying = true;
      audio.volume = 0;
      audio.play().then(() => {
        fadeAudio(0.6, 2000);
      }).catch(() => {});
      btn.classList.remove('muted');
      btn.classList.add('playing');
      label.classList.add('show');
      // Hide label after 5s
      setTimeout(() => label.classList.remove('show'), 5000);
    }
  }

  // Auto-start on first interaction
  let musicAutoStarted = false;
  function autoStartMusic() {
    if (musicAutoStarted) return;
    musicAutoStarted = true;
    if (!musicPlaying) {
      toggleMusic();
    }
  }
</script>
</body>
</html>
